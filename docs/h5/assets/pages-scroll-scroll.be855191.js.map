{"version":3,"file":"pages-scroll-scroll.be855191.js","sources":["../../../../../pages/scroll/scroll.vue"],"sourcesContent":["<template>\n    <view\n        id=\"el\"\n        class=\"page\"\n        @touchstart=\"startFun\"\n        @touchmove=\"moveFun\"\n        @touchend=\"cancelFun\"\n        @touchcancel=\"cancelFun\"\n    >\n        <view\n            class=\"box\"\n            :style=\"boxStyle\"\n        >\n            <view\n                v-for=\"item in list\"\n                :key=\"item\"\n                class=\"item\"\n                :style=\"itemStyle\"\n            >\n                {{ item }} {{ boxStyle }}\n            </view>\n        </view>\n    </view>\n</template>\n\n<script lang=\"ts\" setup>\nimport { onLoad } from '@dcloudio/uni-app'\nimport { ref, onMounted, computed } from 'vue'\n\nconst isTouch = ref(false)\nconst wWidth = ref(0)\nconst wHeight = ref(0)\nconst list = ref(4)\nconst startXY = ref({x: 0, y: 0})\nconst top = ref(0)\nconst oldTop = ref(0)\nconst index = ref(0)\n\nonMounted(() => {\n    const query = uni.createSelectorQuery()\n    query.select('.page').boundingClientRect(data => {\n        if (!data) return\n        const { width = 0, height = 0} = data\n        wWidth.value = width\n        wHeight.value = height\n    }).exec()\n})\n\nconst boxStyle = computed(() => {\n    return {\n        width: `${wWidth.value}px`,\n        height: `${wHeight.value * list.value}px`,\n        top: `${top.value}px`,\n        transition: isTouch.value ? 'none' : 'top 0.5s ease-in-out'\n    }\n})\n\nconst itemStyle = computed(() => {\n    return {\n        width: `${wWidth.value}px`,\n        height: `${wHeight.value}px`\n    }\n})\n\nconst startFun = e => {\n    const { changedTouches = [] } = e\n\n    // 没拿到信息或双指操作\n    if (!changedTouches.length || changedTouches.length === 2) return\n\n    const { pageX: x = 0, pageY: y = 0 } = changedTouches[0]\n    oldTop.value = top.value\n    isTouch.value = true\n\n    startXY.value = {\n        x,\n        y\n    }\n\n    uni.$log({\n        tip: '手指开始触摸位置',\n        msg: `(${x}, ${y})`\n    })\n}\n\n// function getTouch(e: Event) {\n\n// }\n\nconst moveFun = e => {\n    if (!isTouch.value) return\n\n    const { changedTouches = [] } = e\n    const { pageX: x = 0, pageY: y = 0 } = changedTouches[0]\n\n    uni.$log({\n        tip: '手指移动位置',\n        msg: `(${x}, ${y}) (${startXY.value.x}, ${startXY.value.y})`\n    })\n\n    const moveX = x - startXY.value.x\n    const moveY = y - startXY.value.y\n    const isX = Math.abs(moveX) > Math.abs(moveY)\n\n    if (moveY > 0) {\n        top.value = oldTop.value + Math.abs(moveY)\n    } else {\n        top.value = oldTop.value - Math.abs(moveY)\n    }\n\n    console.log(moveX)\n}\n\nconst cancelFun = e => {\n    if (!isTouch.value) return\n    const { changedTouches = [] } = e\n    const { pageX: x = 0, pageY: y = 0 } = changedTouches[0]\n\n    const moveX = x - startXY.value.x\n    const moveY = y - startXY.value.y\n    const isX = Math.abs(moveX) > Math.abs(moveY)\n    isTouch.value = false\n\n    if (moveY > 0) {\n        if (Math.abs(moveY) > 100 && oldTop.value !== 0) {\n            top.value = oldTop.value + wHeight.value\n        } else {\n            top.value = oldTop.value\n        }\n    } else {\n        if (Math.abs(moveY) > 100) {\n            top.value = oldTop.value - wHeight.value\n        } else {\n            top.value = oldTop.value\n        }\n    }\n}\n\n</script>\n\n<style lang=\"scss\" scoped>\n    page {\n        width: 100%;\n        height: 100%;\n    }\n\n    .page {\n        width: 100%;\n        height: 100%;\n        overflow: hidden;\n        position: relative;\n\n        .box {\n            position: absolute;\n            width: 100%;\n            // transition: all 1s;\n            // transform: none;\n        }\n\n        .item {\n            width: 100%;\n        }\n    }\n</style>\n"],"names":["isTouch","ref","wWidth","wHeight","list","startXY","x","y","top","oldTop","uni.createSelectorQuery","select","boundingClientRect","data","width","height","value","exec","boxStyle","computed","transition","itemStyle","startFun","changedTouches","e","length","pageX","pageY","$log","tip","msg","moveFun","moveX","moveY","Math","abs","log","cancelFun"],"mappings":"6OA6BMA,EAAUC,GAAI,GACdC,EAASD,EAAI,GACbE,EAAUF,EAAI,GACdG,EAAOH,EAAI,GACXI,EAAUJ,EAAI,CAACK,EAAG,EAAGC,EAAG,IACxBC,EAAMP,EAAI,GACVQ,EAASR,EAAI,KACD,MAER,KACQS,IACRC,OAAO,SAASC,4BACbC,eACCC,MAAEA,EAAQ,SAAGC,EAAS,GAAKF,IAC1BG,MAAQF,IACPE,MAAQD,KACjBE,gBAGDC,EAAWC,GAAS,KACf,CACHL,MAAO,GAAGZ,EAAOc,UACjBD,OAAWZ,EAAQa,MAAQZ,EAAKY,MAAxB,KACRR,IAAK,GAAGA,EAAIQ,UACZI,WAAYpB,EAAQgB,MAAQ,OAAS,2BAIvCK,EAAYF,GAAS,KAChB,CACHL,MAAO,GAAGZ,EAAOc,UACjBD,OAAQ,GAAGZ,EAAQa,cAIrBM,YACIC,eAAEA,EAAiB,IAAOC,MAG3BD,EAAeE,QAAoC,IAA1BF,EAAeE,oBAErCC,MAAOpB,EAAI,EAAGqB,MAAOpB,EAAI,GAAMgB,EAAe,KAC/CP,MAAQR,EAAIQ,QACXA,OAAQ,IAERA,MAAQ,CACZV,EAAAA,EACAC,EAAAA,OAGAqB,KAAK,CACLC,IAAK,WACLC,IAAK,IAAIxB,MAAMC,QAQjBwB,UACG/B,EAAQgB,mBAEPO,eAAEA,EAAiB,IAAOC,GACxBE,MAAOpB,EAAI,EAAGqB,MAAOpB,EAAI,GAAMgB,EAAe,OAElDK,KAAK,CACLC,IAAK,SACLC,IAAK,IAAIxB,MAAMC,OAAOF,EAAQW,MAAMV,MAAMD,EAAQW,MAAMT,aAGtDyB,EAAQ1B,EAAID,EAAQW,MAAMV,EAC1B2B,EAAQ1B,EAAIF,EAAQW,MAAMT,IAIxBS,MADJiB,EAAQ,EACIxB,EAAOO,MAAQkB,KAAKC,IAAIF,GAExBxB,EAAOO,MAAQkB,KAAKC,IAAIF,WAGhCG,IAAIJ,IAGVK,UACGrC,EAAQgB,mBACPO,eAAEA,EAAiB,IAAOC,GACxBE,MAAOpB,EAAI,EAAGqB,MAAOpB,EAAI,GAAMgB,EAAe,GAEpClB,EAAQW,MAAMV,QAC1B2B,EAAQ1B,EAAIF,EAAQW,MAAMT,IAExBS,OAAQ,EAEZiB,EAAQ,EACJC,KAAKC,IAAIF,GAAS,KAAwB,IAAjBxB,EAAOO,QAC5BA,MAAQP,EAAOO,MAAQb,EAAQa,QAE/BA,MAAQP,EAAOO,MAGnBkB,KAAKC,IAAIF,GAAS,MACdjB,MAAQP,EAAOO,MAAQb,EAAQa,QAE/BA,MAAQP,EAAOO"}