{"version":3,"file":"pages-skeleton-skeleton.dd52f236.js","sources":["../../../../../uni_modules/mview-ui/components/m-skeleton/props.ts","../../../../../uni_modules/mview-ui/components/m-skeleton/m-skeleton.vue","../../../../../pages/skeleton/skeleton.vue"],"sourcesContent":["import { getDefault } from '../props'\n\nexport default {\n    // 是否展示骨架组件\n    loading: {\n        type: Boolean,\n        default: getDefault('skeleton', 'loading')\n    },\n    // 是否开启动画效果\n    animate: {\n        type: Boolean,\n        default: getDefault('skeleton', 'animate')\n    },\n    // 段落占位图行数\n    rows: {\n        type: [String, Number],\n        default: getDefault('skeleton', 'rows')\n    },\n    // 段落占位图的宽度\n    rowsWidth: {\n        type: [String, Number, Array],\n        default: getDefault('skeleton', 'rowsWidth')\n    },\n    // 段落占位图的高度\n    rowsHeight: {\n        type: [String, Number, Array],\n        default: getDefault('skeleton', 'rowsHeight')\n    },\n    // 是否展示标题占位图\n    title: {\n        type: Boolean,\n        default: getDefault('skeleton', 'title')\n    },\n    // 段落标题的宽度\n    titleWidth: {\n        type: [String, Number],\n        default: getDefault('skeleton', 'titleWidth')\n    },\n    // 段落标题的高度\n    titleHeight: {\n        type: [String, Number],\n        default: getDefault('skeleton', 'titleHeight')\n    },\n    // 是否展示头像占位图\n    avatar: {\n        type: Boolean,\n        default: getDefault('skeleton', 'avatar')\n    },\n    // 头像占位图大小\n    avatarSize: {\n        type: [String, Number],\n        default: getDefault('skeleton', 'avatarSize')\n    },\n    // 头像占位图的形状，circle-圆形，square-方形\n    avatarShape: {\n        type: String,\n        default: getDefault('skeleton', 'avatarShape')\n    }\n}\n","<template>\n    <view class=\"m-skeleton\">\n        <view class=\"m-skeleton__wrapper\" v-if=\"props.loading\" style=\"display: flex; flex-direction: row;\">\n            <view\n                class=\"m-skeleton__wrapper__avatar\"\n                v-if=\"props.avatar\"\n                :class=\"[`m-skeleton__wrapper__avatar--${props.avatarShape}`, props.animate && 'animate']\"\n                :style=\"avatarStyle\"\n            ></view>\n           <view class=\"m-skeleton__wrapper__content\" ref=\"m-skeleton__wrapper__content\" style=\"flex: 1;\">\n                <view\n                    class=\"m-skeleton__wrapper__content__title\"\n                    v-if=\"props.title\"\n                    :style=\"titleStyle\"\n                    :class=\"[props.animate && 'animate']\"\n                ></view>\n                <view\n                    class=\"m-skeleton__wrapper__content__rows\"\n                    :class=\"[props.animate && 'animate']\"\n                    v-for=\"(item, index) in rowsArray\"\n                    :key=\"index\"\n                    :style=\"rowStyle(item)\"\n                ></view>\n            </view>\n        </view>\n        <slot v-else />\n    </view>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ref, computed, onMounted, getCurrentInstance } from 'vue'\nimport Props from './props'\n\nconst props = defineProps(Props)\nconst width = ref(0)\nconst currentInstance = getCurrentInstance()\n\nonMounted(() => {\n    getComponentWidth()\n})\n\nconst avatarStyle = computed(() => {\n    return {\n        height: uni.$m.addUnit(props.avatarSize),\n        width: uni.$m.addUnit(props.avatarSize)\n    }\n})\n\nconst titleStyle = computed(() => {\n    let tWidth = 0\n\n    if (/%$/.test(props.titleWidth)) {\n        // 通过parseInt提取出百分比单位中的数值部分，除以100得到百分比的小数值\n        tWidth = uni.$m.addUnit(width.value * parseInt(props.titleWidth) / 100)\n    } else {\n        tWidth = uni.$m.addUnit(props.titleWidth)\n    }\n\n    return {\n        width: uni.$m.addUnit(tWidth),\n        height: uni.$m.addUnit(props.titleHeight),\n    }\n})\n\nconst rowStyle = computed(() => {\n    return item => ({\n        width: item.width,\n        height: item.height,\n        marginTop: item.marginTop\n    })\n})\n\nconst rowsArray = computed(() => {\n    if (/%$/.test(props.rowsHeight)) {\n        console.error('rowsHeight参数不支持百分比单位')\n    }\n\n    const rows = []\n    let px = ''\n\n    if (uni.$m.test.string(props.rowsWidth)) px = props.rowsWidth.replace(/[0-9]/g, '')\n\n    if (!px) px = 'px'\n\n    for (let i = 0; i < props.rows; i++) {\n        let item = {}\n        // 需要预防超出数组边界的情况\n        let rowWidth = uni.$m.test.array(props.rowsWidth) ? (props.rowsWidth[i] || (i === props.row - 1 ? '70%' : '100%')) : i === props.rows - 1 ? Number.parseFloat(props.rowsWidth) * 0.7 + px  : props.rowsWidth\n        let rowHeight = uni.$m.test.array(props.rowsHeight) ? (props.rowsHeight[i] || '18px') : props.rowsHeight\n        // 如果有title占位图，第一个段落占位图的外边距需要大一些，如果没有title占位图，第一个段落占位图则无需外边距\n        // 之所以需要这么做，是因为weex的无能，以提升性能为借口不支持css的一些伪类\n        item.marginTop = !props.title && i === 0 ? 0 : props.title && i === 0 ? '20px' : '12px'\n        // 如果设置的为百分比的宽度，转换为px值，因为nvue不支持百分比单位\n        if (/%$/.test(rowWidth)) {\n            // 通过parseInt提取出百分比单位中的数值部分，除以100得到百分比的小数值\n            item.width = uni.$m.addUnit(width.value * Number.parseInt(rowWidth) / 100)\n        } else {\n            item.width = uni.$m.addUnit(rowWidth)\n        }\n        item.height = uni.$m.addUnit(rowHeight)\n        rows.push(item)\n    }\n\n    return rows\n})\n\n// 获取组件的宽度\nasync function getComponentWidth () {\n    // 延时一定时间，以获取dom尺寸\n    await uni.$m.sleep(20)\n    uni.createSelectorQuery().in(currentInstance).select('.m-skeleton__wrapper__content').boundingClientRect(data => {\n        width.value = data.width\n    }).exec()\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../libs/css/components.scss';\n\n@mixin background {\n    /* #ifdef APP-NVUE */\n    background-color: #f1f2f4;\n    /* #endif */\n    /* #ifndef APP-NVUE */\n    background: linear-gradient(90deg, #f1f2f4 25%, #e6e6e6 37%, #f1f2f4 50%);\n    background-size: 400% 100%;\n    /* #endif */\n}\n\n.m-skeleton {\n    flex: 1;\n\n    &__wrapper {\n        @include flex(row);\n\n        &__avatar {\n            @include background;\n            margin-right: 15px;\n\n            &--circle {\n                border-radius: 100px;\n            }\n\n            &--square {\n                border-radius: 4px;\n            }\n        }\n\n        &__content {\n            flex: 1;\n\n            &__rows,\n            &__title {\n                @include background;\n                border-radius: 3px;\n            }\n        }\n    }\n}\n\n/* #ifndef APP-NVUE */\n.animate {\n    animation: skeleton 1.8s ease infinite;\n}\n\n@keyframes skeleton {\n    0% {\n        background-position: 100% 50%;\n    }\n\n    100% {\n        background-position: 0 50%;\n    }\n}\n\n/* #endif */\n</style>\n","<template>\n    <view class=\"page\">\n        <m-common title=\"骨架屏\" />\n        <view class=\"txt\">\n            基本使用\n        </view>\n        <m-skeleton\n            loading\n            title\n            :animate=\"false\"\n            rows=\"3\"\n        />\n        <view class=\"txt\">\n            不使用动画\n        </view>\n        <m-skeleton\n            loading\n            :animate=\"false\"\n        />\n        <view class=\"txt\">\n            显示头像\n        </view>\n        <m-skeleton\n            loading\n            avatar\n            rows=\"2\"\n        />\n    </view>\n</template>\n\n<script>\nexport default {\n    data() {\n        return {\n\n        }\n    },\n    methods: {\n\n    }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.page {\n    padding: $m-pad;\n\n    .txt {\n        font-size: 14px;\n        color: #8f9ca2;\n        padding: 10px 0;\n    }\n}\n</style>\n"],"names":["loading","type","Boolean","default","getDefault","animate","rows","String","Number","rowsWidth","Array","rowsHeight","title","titleWidth","titleHeight","avatar","avatarSize","avatarShape","width","ref","currentInstance","getCurrentInstance","uni","$m","sleep","in","select","boundingClientRect","value","data","exec","avatarStyle","computed","height","addUnit","props","titleStyle","tWidth","test","parseInt","rowStyle","item","marginTop","rowsArray","error","px","string","replace","i","rowWidth","array","row","parseFloat","rowHeight","push","methods","_createBlock","_component_v_uni_view","class","_createVNode","_component_m_common","_component_m_skeleton"],"mappings":"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"}