{"version":3,"file":"pages-skeleton-skeleton.366b01e1.js","sources":["../../../../../uni_modules/mview-ui/components/m-skeleton/props.ts","../../../../../uni_modules/mview-ui/components/m-skeleton/m-skeleton.vue","../../../../../pages/skeleton/skeleton.vue"],"sourcesContent":["export default {\n    // 是否展示骨架组件\n    loading: {\n        type: Boolean,\n        default: uni.$m.props.skeleton.loading\n    },\n    // 是否开启动画效果\n    animate: {\n        type: Boolean,\n        default: uni.$m.props.skeleton.animate\n    },\n    // 段落占位图行数\n    rows: {\n        type: [String, Number],\n        default: uni.$m.props.skeleton.rows\n    },\n    // 段落占位图的宽度\n    rowsWidth: {\n        type: [String, Number, Array],\n        default: uni.$m.props.skeleton.rowsWidth\n    },\n    // 段落占位图的高度\n    rowsHeight: {\n        type: [String, Number, Array],\n        default: uni.$m.props.skeleton.rowsHeight\n    },\n    // 是否展示标题占位图\n    title: {\n        type: Boolean,\n        default: uni.$m.props.skeleton.title\n    },\n    // 段落标题的宽度\n    titleWidth: {\n        type: [String, Number],\n        default: uni.$m.props.skeleton.titleWidth\n    },\n    // 段落标题的高度\n    titleHeight: {\n        type: [String, Number],\n        default: uni.$m.props.skeleton.titleHeight\n    },\n    // 是否展示头像占位图\n    avatar: {\n        type: Boolean,\n        default: uni.$m.props.skeleton.avatar\n    },\n    // 头像占位图大小\n    avatarSize: {\n        type: [String, Number],\n        default: uni.$m.props.skeleton.avatarSize\n    },\n    // 头像占位图的形状，circle-圆形，square-方形\n    avatarShape: {\n        type: String,\n        default: uni.$m.props.skeleton.avatarShape\n    }\n}","<template>\n    <view class=\"m-skeleton\">\n        <view class=\"m-skeleton__wrapper\" v-if=\"props.loading\" style=\"display: flex; flex-direction: row;\">\n            <view\n                class=\"m-skeleton__wrapper__avatar\"\n                v-if=\"props.avatar\"\n                :class=\"[`m-skeleton__wrapper__avatar--${props.avatarShape}`, props.animate && 'animate']\"\n                :style=\"avatarStyle\"\n            ></view>\n           <view class=\"m-skeleton__wrapper__content\" ref=\"m-skeleton__wrapper__content\" style=\"flex: 1;\">\n                <view\n                    class=\"m-skeleton__wrapper__content__title\"\n                    v-if=\"props.title\"\n                    :style=\"titleStyle\"\n                    :class=\"[props.animate && 'animate']\"\n                ></view>\n                <view\n                    class=\"m-skeleton__wrapper__content__rows\"\n                    :class=\"[props.animate && 'animate']\"\n                    v-for=\"(item, index) in rowsArray\"\n                    :key=\"index\"\n                    :style=\"rowStyle(item)\"\n                ></view>\n            </view>\n        </view>\n        <slot v-else />\n    </view>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ref, computed, onMounted, getCurrentInstance } from 'vue'\nimport Props from './props'\n\nconst props = defineProps(Props)\nconst width = ref(0)\nconst currentInstance = getCurrentInstance()\n\nonMounted(() => {\n    getComponentWidth()\n})\n\nconst avatarStyle = computed(() => {\n    return {\n        height: uni.$m.addUnit(props.avatarSize),\n        width: uni.$m.addUnit(props.avatarSize)\n    }\n})\n\nconst titleStyle = computed(() => {\n    let tWidth = 0\n\n    if (/%$/.test(props.titleWidth)) {\n        // 通过parseInt提取出百分比单位中的数值部分，除以100得到百分比的小数值\n        tWidth = uni.$m.addUnit(width.value * parseInt(props.titleWidth) / 100)\n    } else {\n        tWidth = uni.$m.addUnit(props.titleWidth)\n    }\n\n    return {\n        width: uni.$m.addUnit(tWidth),\n        height: uni.$m.addUnit(props.titleHeight),\n    }\n})\n\nconst rowStyle = computed(() => {\n    return item => ({\n        width: item.width,\n        height: item.height,\n        marginTop: item.marginTop\n    })\n})\n\nconst rowsArray = computed(() => {\n    if (/%$/.test(props.rowsHeight)) {\n        console.error('rowsHeight参数不支持百分比单位')\n    }\n\n    const rows = []\n    let px = ''\n\n    if (uni.$m.test.string(props.rowsWidth)) px = props.rowsWidth.replace(/[0-9]/g, '')\n\n    if (!px) px = 'px'\n\n    for (let i = 0; i < props.rows; i++) {\n        let item = {}\n        // 需要预防超出数组边界的情况\n        let rowWidth = uni.$m.test.array(props.rowsWidth) ? (props.rowsWidth[i] || (i === props.row - 1 ? '70%' : '100%')) : i === props.rows - 1 ? Number.parseFloat(props.rowsWidth) * 0.7 + px  : props.rowsWidth\n        let rowHeight = uni.$m.test.array(props.rowsHeight) ? (props.rowsHeight[i] || '18px') : props.rowsHeight\n        // 如果有title占位图，第一个段落占位图的外边距需要大一些，如果没有title占位图，第一个段落占位图则无需外边距\n        // 之所以需要这么做，是因为weex的无能，以提升性能为借口不支持css的一些伪类\n        item.marginTop = !props.title && i === 0 ? 0 : props.title && i === 0 ? '20px' : '12px'\n        // 如果设置的为百分比的宽度，转换为px值，因为nvue不支持百分比单位\n        if (/%$/.test(rowWidth)) {\n            // 通过parseInt提取出百分比单位中的数值部分，除以100得到百分比的小数值\n            item.width = uni.$m.addUnit(width.value * Number.parseInt(rowWidth) / 100)\n        } else {\n            item.width = uni.$m.addUnit(rowWidth)\n        }\n        item.height = uni.$m.addUnit(rowHeight)\n        rows.push(item)\n    }\n\n    return rows\n})\n\n// 获取组件的宽度\nasync function getComponentWidth () {\n    // 延时一定时间，以获取dom尺寸\n    await uni.$m.sleep(20)\n    uni.createSelectorQuery().in(currentInstance).select('.m-skeleton__wrapper__content').boundingClientRect(data => {\n        width.value = data.width\n    }).exec()\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../libs/css/components.scss';\n\n@mixin background {\n    /* #ifdef APP-NVUE */\n    background-color: #f1f2f4;\n    /* #endif */\n    /* #ifndef APP-NVUE */\n    background: linear-gradient(90deg, #f1f2f4 25%, #e6e6e6 37%, #f1f2f4 50%);\n    background-size: 400% 100%;\n    /* #endif */\n}\n\n.m-skeleton {\n    flex: 1;\n\n    &__wrapper {\n        @include flex(row);\n\n        &__avatar {\n            @include background;\n            margin-right: 15px;\n\n            &--circle {\n                border-radius: 100px;\n            }\n\n            &--square {\n                border-radius: 4px;\n            }\n        }\n\n        &__content {\n            flex: 1;\n\n            &__rows,\n            &__title {\n                @include background;\n                border-radius: 3px;\n            }\n        }\n    }\n}\n\n/* #ifndef APP-NVUE */\n.animate {\n    animation: skeleton 1.8s ease infinite;\n}\n\n@keyframes skeleton {\n    0% {\n        background-position: 100% 50%;\n    }\n\n    100% {\n        background-position: 0 50%;\n    }\n}\n\n/* #endif */\n</style>\n","<template>\n    <view class=\"page\">\n        <m-common title=\"骨架屏\" />\n        <view class=\"txt\">\n            基本使用\n        </view>\n        <m-skeleton\n            loading\n            title\n            :animate=\"false\"\n            rows=\"3\"\n        />\n        <view class=\"txt\">\n            不使用动画\n        </view>\n        <m-skeleton\n            loading\n            :animate=\"false\"\n        />\n        <view class=\"txt\">\n            显示头像\n        </view>\n        <m-skeleton\n            loading\n            avatar\n            rows=\"2\"\n        />\n    </view>\n</template>\n\n<script>\nexport default {\n    data() {\n        return {\n\n        }\n    },\n    methods: {\n\n    }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.page {\n    padding: $m-pad;\n\n    .txt {\n        font-size: 14px;\n        color: #8f9ca2;\n        padding: 10px 0;\n    }\n}\n</style>\n"],"names":["loading","type","Boolean","default","uni","$m","props","skeleton","animate","rows","String","Number","rowsWidth","Array","rowsHeight","title","titleWidth","titleHeight","avatar","avatarSize","avatarShape","width","ref","currentInstance","getCurrentInstance","sleep","in","select","boundingClientRect","value","data","exec","avatarStyle","computed","height","addUnit","titleStyle","tWidth","test","parseInt","rowStyle","item","marginTop","rowsArray","error","px","string","replace","i","rowWidth","array","row","parseFloat","rowHeight","push","methods","_createBlock","_component_v_uni_view","class","_createVNode","_component_m_common","_component_m_skeleton"],"mappings":"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"}